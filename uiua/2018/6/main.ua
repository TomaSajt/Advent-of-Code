MakeArea ← |2 +⊙⍉∩(⌵-)⊙: ∩⍉ ∩↯ ⊃(⋅∘|⇡|∘|⋅⇡) ∩⍘⊟
GetMaxPos ← (⋅∞|∘) ⊃(=1⧻|⊢)⊚ =/↧.
MakeDenyList ← ⊝⊂∞⊂⊂⊂⊃(⊢⇌⍉|⊢⍉|⊢⇌|⊢)

≡MakeArea ¤+1/↥. ↯¯1_2 ⊜parse ¬∊:"\n\r\s," . &fras "input.txt"

⊃(/+/+<10000/+|/↥ ⍘⊚ ▽⊃(¬∊|∘) ⊃(♭|MakeDenyList) ≡≡GetMaxPos ⍉≡⍉)
