N ← 1000000000
Probe ← 170 # Change to higher number if you get an error
SlideE ← ≡(⍜⊜□≡⍜°□(⊏⍏.)≠@#.)
Cycle ← ⍥(SlideE⍉⇌)4
MoveA ← ⍜(⍉⇌)SlideE
MoveB ← ⍥Cycle◿⊙⊃(-:N|⊡)⊃-∘⊃⊡∘⊢⊚≠⇡⧻..⊛.⇌[⍥(Cycle.)Probe]

&fras "input.txt"
⊜∘ ¬∈"\r\n".
⊃(MoveB|MoveA)
∩(/+♭×⇌+1⇡⧻.=@O)
